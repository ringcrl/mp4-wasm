var Gr=Object.defineProperty;var me=p=>Gr(p,"__esModule",{value:!0});var we=(p,t)=>{for(var u in t)Gr(p,u,{get:t[u],enumerable:!0})};me(exports);we(exports,{createFile:()=>Wr,createWebCodecsEncoderWithModule:()=>Qr,isWebCodecsSupported:()=>kr});var ur=function(){var p=typeof document!="undefined"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename!="undefined"&&(p=p||__filename),function(t){t=t||{};var t=typeof t!="undefined"?t:{},u,_;t.ready=new Promise(function(r,n){u=r,_=n}),t.create_buffer=function(n){return t._malloc(n)},t.free_buffer=function(n){return t._free(n)},t.locateFile=function(n,e){return t.simd&&(n=n.replace(/\.wasm$/i,".simd.wasm")),t.getWasmPath?t.getWasmPath(n,e,t.simd):e+n},t.createWebCodecsEncoder=function(n){return Qr(t,n)};var y={},l;for(l in t)t.hasOwnProperty(l)&&(y[l]=t[l]);var h=[],k="./this.program",I=function(r,n){throw n},x=!1,Q=!1,M=!0,b="";function U(r){return t.locateFile?t.locateFile(r,b):b+r}var N,lr,Y,O,q;M&&(Q?b=require("path").dirname(b)+"/":b=__dirname+"/",N=function(n,e){return O||(O=require("fs")),q||(q=require("path")),n=q.normalize(n),O.readFileSync(n,e?null:"utf8")},Y=function(n){var e=N(n,!0);return e.buffer||(e=new Uint8Array(e)),X(e.buffer),e},lr=function(n,e,i){O||(O=require("fs")),q||(q=require("path")),n=q.normalize(n),O.readFile(n,function(a,f){a?i(a):e(f.buffer)})},process.argv.length>1&&(k=process.argv[1].replace(/\\/g,"/")),h=process.argv.slice(2),process.on("uncaughtException",function(r){if(!(r instanceof de))throw r}),process.on("unhandledRejection",J),I=function(r,n){if(cn())throw process.exitCode=r,n;process.exit(r)},t.inspect=function(){return"[Emscripten Module object]"});var ar=t.print||console.log.bind(console),F=t.printErr||console.warn.bind(console);for(l in y)y.hasOwnProperty(l)&&(t[l]=y[l]);y=null,t.arguments&&(h=t.arguments),t.thisProgram&&(k=t.thisProgram),t.quit&&(I=t.quit);var K;t.wasmBinary&&(K=t.wasmBinary);var _r=t.noExitRuntime||!0;typeof WebAssembly!="object"&&J("no native wasm support detected");var rr,m=!1,w;function X(r,n){r||J("Assertion failed: "+n)}function D(r,n,e){for(var i=n+e,a="";!(n>=i);){var f=r[n++];if(!f)return a;if(!(f&128)){a+=String.fromCharCode(f);continue}var c=r[n++]&63;if((f&224)==192){a+=String.fromCharCode((f&31)<<6|c);continue}var o=r[n++]&63;if((f&240)==224?f=(f&15)<<12|c<<6|o:f=(f&7)<<18|c<<12|o<<6|r[n++]&63,f<65536)a+=String.fromCharCode(f);else{var s=f-65536;a+=String.fromCharCode(55296|s>>10,56320|s&1023)}}return a}function V(r,n){return r?D(C,r,n):""}function vr(r,n,e,i){if(!(i>0))return 0;for(var a=e,f=e+i-1,c=0;c<r.length;++c){var o=r.charCodeAt(c);if(o>=55296&&o<=57343){var s=r.charCodeAt(++c);o=65536+((o&1023)<<10)|s&1023}if(o<=127){if(e>=f)break;n[e++]=o}else if(o<=2047){if(e+1>=f)break;n[e++]=192|o>>6,n[e++]=128|o&63}else if(o<=65535){if(e+2>=f)break;n[e++]=224|o>>12,n[e++]=128|o>>6&63,n[e++]=128|o&63}else{if(e+3>=f)break;n[e++]=240|o>>18,n[e++]=128|o>>12&63,n[e++]=128|o>>6&63,n[e++]=128|o&63}}return n[e]=0,e-a}function W(r,n,e){return vr(r,C,n,e)}function R(r){for(var n=0,e=0;e<r.length;++e){var i=r.charCodeAt(e);i>=55296&&i<=57343&&(i=65536+((i&1023)<<10)|r.charCodeAt(++e)&1023),i<=127?++n:i<=2047?n+=2:i<=65535?n+=3:n+=4}return n}function Mr(r,n){for(var e="",i=0;!(i>=n/2);++i){var a=nr[r+i*2>>1];if(a==0)break;e+=String.fromCharCode(a)}return e}function rn(r,n,e){if(e===void 0&&(e=2147483647),e<2)return 0;e-=2;for(var i=n,a=e<r.length*2?e/2:r.length,f=0;f<a;++f){var c=r.charCodeAt(f);nr[n>>1]=c,n+=2}return nr[n>>1]=0,n-i}function nn(r){return r.length*2}function en(r,n){for(var e=0,i="";!(e>=n/4);){var a=H[r+e*4>>2];if(a==0)break;if(++e,a>=65536){var f=a-65536;i+=String.fromCharCode(55296|f>>10,56320|f&1023)}else i+=String.fromCharCode(a)}return i}function tn(r,n,e){if(e===void 0&&(e=2147483647),e<4)return 0;for(var i=n,a=i+e-4,f=0;f<r.length;++f){var c=r.charCodeAt(f);if(c>=55296&&c<=57343){var o=r.charCodeAt(++f);c=65536+((c&1023)<<10)|o&1023}if(H[n>>2]=c,n+=4,n+4>a)break}return H[n>>2]=0,n-i}function an(r){for(var n=0,e=0;e<r.length;++e){var i=r.charCodeAt(e);i>=55296&&i<=57343&&++e,n+=4}return n}function on(r,n){return r%n>0&&(r+=n-r%n),r}var gr,dr,C,nr,yr,H,L,Ir,Or;function Dr(r){gr=r,t.HEAP8=dr=new Int8Array(r),t.HEAP16=nr=new Int16Array(r),t.HEAP32=H=new Int32Array(r),t.HEAPU8=C=new Uint8Array(r),t.HEAPU16=yr=new Uint16Array(r),t.HEAPU32=L=new Uint32Array(r),t.HEAPF32=Ir=new Float32Array(r),t.HEAPF64=Or=new Float64Array(r)}var Fe=t.INITIAL_MEMORY||16777216,or,Vr=[],Hr=[],Lr=[],fn=!1,sn=0;function cn(){return _r||sn>0}function un(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)pn(t.preRun.shift());wr(Vr)}function ln(){fn=!0,wr(Hr)}function vn(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)_n(t.postRun.shift());wr(Lr)}function pn(r){Vr.unshift(r)}function hn(r){Hr.unshift(r)}function _n(r){Lr.unshift(r)}var $=0,mr=null,fr=null;function gn(r){$++,t.monitorRunDependencies&&t.monitorRunDependencies($)}function dn(r){if($--,t.monitorRunDependencies&&t.monitorRunDependencies($),$==0&&(mr!==null&&(clearInterval(mr),mr=null),fr)){var n=fr;fr=null,n()}}t.preloadedImages={},t.preloadedAudios={};function J(r){t.onAbort&&t.onAbort(r),r+="",F(r),m=!0,w=1,r="abort("+r+"). Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(r);throw _(n),n}var yn="data:application/octet-stream;base64,";function jr(r){return r.startsWith(yn)}var S;S="mp4.node.wasm",jr(S)||(S=U(S));function Br(r){try{if(r==S&&K)return new Uint8Array(K);if(Y)return Y(r);throw"both async and sync fetching of the wasm failed"}catch(n){J(n)}}function mn(){return!K&&(x||Q)&&typeof fetch=="function"?fetch(S,{credentials:"same-origin"}).then(function(r){if(!r.ok)throw"failed to load wasm binary file at '"+S+"'";return r.arrayBuffer()}).catch(function(){return Br(S)}):Promise.resolve().then(function(){return Br(S)})}function wn(){var r={a:pe};function n(c,o){var s=c.exports;t.asm=s,rr=t.asm.x,Dr(rr.buffer),or=t.asm.B,hn(t.asm.y),dn("wasm-instantiate")}gn("wasm-instantiate");function e(c){n(c.instance)}function i(c){return mn().then(function(o){return WebAssembly.instantiate(o,r)}).then(function(o){return o}).then(c,function(o){F("failed to asynchronously prepare wasm: "+o),J(o)})}function a(){return!K&&typeof WebAssembly.instantiateStreaming=="function"&&!jr(S)&&typeof fetch=="function"?fetch(S,{credentials:"same-origin"}).then(function(c){var o=WebAssembly.instantiateStreaming(c,r);return o.then(e,function(s){return F("wasm streaming compile failed: "+s),F("falling back to ArrayBuffer instantiation"),i(e)})}):i(e)}if(t.instantiateWasm)try{var f=t.instantiateWasm(r,n);return f}catch(c){return F("Module.instantiateWasm callback failed with error: "+c),!1}return a().catch(_),{}}function wr(r){for(;r.length>0;){var n=r.shift();if(typeof n=="function"){n(t);continue}var e=n.func;typeof e=="number"?n.arg===void 0?or.get(e)():or.get(e)(n.arg):e(n.arg===void 0?null:n.arg)}}function bn(r,n,e,i){J("Assertion failed: "+V(r)+", at: "+[n?V(n):"unknown filename",e,i?V(i):"unknown function"])}function An(r,n,e,i,a){}function br(r){switch(r){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+r)}}function En(){for(var r=new Array(256),n=0;n<256;++n)r[n]=String.fromCharCode(n);Nr=r}var Nr=void 0;function P(r){for(var n="",e=r;C[e];)n+=Nr[C[e++]];return n}var er={},Z={},pr={},Tn=48,Fn=57;function qr(r){if(r===void 0)return"_unknown";r=r.replace(/[^a-zA-Z0-9_]/g,"$");var n=r.charCodeAt(0);return n>=Tn&&n<=Fn?"_"+r:r}function zr(r,n){return r=qr(r),new Function("body","return function "+r+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(n)}function Ar(r,n){var e=zr(n,function(i){this.name=n,this.message=i;var a=new Error(i).stack;a!==void 0&&(this.stack=this.toString()+`
`+a.replace(/^Error(:[^\n]*)?\n/,""))});return e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},e}var xr=void 0;function A(r){throw new xr(r)}var Yr=void 0;function Kr(r){throw new Yr(r)}function Cn(r,n,e){r.forEach(function(o){pr[o]=n});function i(o){var s=e(o);s.length!==r.length&&Kr("Mismatched type converter count");for(var v=0;v<r.length;++v)j(r[v],s[v])}var a=new Array(n.length),f=[],c=0;n.forEach(function(o,s){Z.hasOwnProperty(o)?a[s]=Z[o]:(f.push(o),er.hasOwnProperty(o)||(er[o]=[]),er[o].push(function(){a[s]=Z[o],++c,c===f.length&&i(a)}))}),f.length===0&&i(a)}function j(r,n,e){if(e=e||{},!("argPackAdvance"in n))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=n.name;if(r||A('type "'+i+'" must have a positive integer typeid pointer'),Z.hasOwnProperty(r)){if(e.ignoreDuplicateRegistrations)return;A("Cannot register type '"+i+"' twice")}if(Z[r]=n,delete pr[r],er.hasOwnProperty(r)){var a=er[r];delete er[r],a.forEach(function(f){f()})}}function Pn(r,n,e,i,a){var f=br(e);n=P(n),j(r,{name:n,fromWireType:function(c){return!!c},toWireType:function(c,o){return o?i:a},argPackAdvance:8,readValueFromPointer:function(c){var o;if(e===1)o=dr;else if(e===2)o=nr;else if(e===4)o=H;else throw new TypeError("Unknown boolean type size: "+n);return this.fromWireType(o[c>>f])},destructorFunction:null})}var Er=[],E=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Tr(r){r>4&&--E[r].refcount==0&&(E[r]=void 0,Er.push(r))}function Un(){for(var r=0,n=5;n<E.length;++n)E[n]!==void 0&&++r;return r}function Rn(){for(var r=5;r<E.length;++r)if(E[r]!==void 0)return E[r];return null}function Sn(){t.count_emval_handles=Un,t.get_first_emval=Rn}function tr(r){switch(r){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var n=Er.length?Er.pop():E.length;return E[n]={refcount:1,value:r},n}}}function Fr(r){return this.fromWireType(L[r>>2])}function Wn(r,n){n=P(n),j(r,{name:n,fromWireType:function(e){var i=E[e].value;return Tr(e),i},toWireType:function(e,i){return tr(i)},argPackAdvance:8,readValueFromPointer:Fr,destructorFunction:null})}function Cr(r){if(r===null)return"null";var n=typeof r;return n==="object"||n==="array"||n==="function"?r.toString():""+r}function kn(r,n){switch(n){case 2:return function(e){return this.fromWireType(Ir[e>>2])};case 3:return function(e){return this.fromWireType(Or[e>>3])};default:throw new TypeError("Unknown float type: "+r)}}function In(r,n,e){var i=br(e);n=P(n),j(r,{name:n,fromWireType:function(a){return a},toWireType:function(a,f){if(typeof f!="number"&&typeof f!="boolean")throw new TypeError('Cannot convert "'+Cr(f)+'" to '+this.name);return f},argPackAdvance:8,readValueFromPointer:kn(n,i),destructorFunction:null})}function On(r,n){if(!(r instanceof Function))throw new TypeError("new_ called with constructor type "+typeof r+" which is not a function");var e=zr(r.name||"unknownFunctionName",function(){});e.prototype=r.prototype;var i=new e,a=r.apply(i,n);return a instanceof Object?a:i}function Xr(r){for(;r.length;){var n=r.pop(),e=r.pop();e(n)}}function Dn(r,n,e,i,a){var f=n.length;f<2&&A("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=n[1]!==null&&e!==null,o=!1,s=1;s<n.length;++s)if(n[s]!==null&&n[s].destructorFunction===void 0){o=!0;break}for(var v=n[0].name!=="void",g="",d="",s=0;s<f-2;++s)g+=(s!==0?", ":"")+"arg"+s,d+=(s!==0?", ":"")+"arg"+s+"Wired";var T="return function "+qr(r)+"("+g+`) {
if (arguments.length !== `+(f-2)+`) {
throwBindingError('function `+r+" called with ' + arguments.length + ' arguments, expected "+(f-2)+` args!');
}
`;o&&(T+=`var destructors = [];
`);var G=o?"destructors":"null",z=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],cr=[A,i,a,Xr,n[0],n[1]];c&&(T+="var thisWired = classParam.toWireType("+G+`, this);
`);for(var s=0;s<f-2;++s)T+="var arg"+s+"Wired = argType"+s+".toWireType("+G+", arg"+s+"); // "+n[s+2].name+`
`,z.push("argType"+s),cr.push(n[s+2]);if(c&&(d="thisWired"+(d.length>0?", ":"")+d),T+=(v?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+`);
`,o)T+=`runDestructors(destructors);
`;else for(var s=c?1:2;s<n.length;++s){var ir=s===1?"thisWired":"arg"+(s-2)+"Wired";n[s].destructorFunction!==null&&(T+=ir+"_dtor("+ir+"); // "+n[s].name+`
`,z.push(ir+"_dtor"),cr.push(n[s].destructorFunction))}v&&(T+=`var ret = retType.fromWireType(rv);
return ret;
`),T+=`}
`,z.push(T);var ye=On(Function,z).apply(null,cr);return ye}function Vn(r,n,e){if(r[n].overloadTable===void 0){var i=r[n];r[n]=function(){return r[n].overloadTable.hasOwnProperty(arguments.length)||A("Function '"+e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+r[n].overloadTable+")!"),r[n].overloadTable[arguments.length].apply(this,arguments)},r[n].overloadTable=[],r[n].overloadTable[i.argCount]=i}}function Hn(r,n,e){t.hasOwnProperty(r)?((e===void 0||t[r].overloadTable!==void 0&&t[r].overloadTable[e]!==void 0)&&A("Cannot register public name '"+r+"' twice"),Vn(t,r,r),t.hasOwnProperty(e)&&A("Cannot register multiple overloads of a function with the same number of arguments ("+e+")!"),t[r].overloadTable[e]=n):(t[r]=n,e!==void 0&&(t[r].numArguments=e))}function Ln(r,n){for(var e=[],i=0;i<r;i++)e.push(H[(n>>2)+i]);return e}function jn(r,n,e){t.hasOwnProperty(r)||Kr("Replacing nonexistant public symbol"),t[r].overloadTable!==void 0&&e!==void 0?t[r].overloadTable[e]=n:(t[r]=n,t[r].argCount=e)}function Bn(r,n,e){var i=t["dynCall_"+r];return e&&e.length?i.apply(null,[n].concat(e)):i.call(null,n)}function Nn(r,n,e){return r.includes("j")?Bn(r,n,e):or.get(n).apply(null,e)}function qn(r,n){var e=[];return function(){e.length=arguments.length;for(var i=0;i<arguments.length;i++)e[i]=arguments[i];return Nn(r,n,e)}}function zn(r,n){r=P(r);function e(){return r.includes("j")?qn(r,n):or.get(n)}var i=e();return typeof i!="function"&&A("unknown function pointer with signature "+r+": "+n),i}var $r=void 0;function Jr(r){var n=Zr(r),e=P(n);return B(n),e}function xn(r,n){var e=[],i={};function a(f){if(!i[f]&&!Z[f]){if(pr[f]){pr[f].forEach(a);return}e.push(f),i[f]=!0}}throw n.forEach(a),new $r(r+": "+e.map(Jr).join([", "]))}function Yn(r,n,e,i,a,f){var c=Ln(n,e);r=P(r),a=zn(i,a),Hn(r,function(){xn("Cannot call "+r+" due to unbound types",c)},n-1),Cn([],c,function(o){var s=[o[0],null].concat(o.slice(1));return jn(r,Dn(r,s,null,a,f),n-1),[]})}function Kn(r,n,e){switch(n){case 0:return e?function(a){return dr[a]}:function(a){return C[a]};case 1:return e?function(a){return nr[a>>1]}:function(a){return yr[a>>1]};case 2:return e?function(a){return H[a>>2]}:function(a){return L[a>>2]};default:throw new TypeError("Unknown integer type: "+r)}}function Xn(r,n,e,i,a){n=P(n),a===-1&&(a=4294967295);var f=br(e),c=function(v){return v};if(i===0){var o=32-8*e;c=function(v){return v<<o>>>o}}var s=n.includes("unsigned");j(r,{name:n,fromWireType:c,toWireType:function(v,g){if(typeof g!="number"&&typeof g!="boolean")throw new TypeError('Cannot convert "'+Cr(g)+'" to '+this.name);if(g<i||g>a)throw new TypeError('Passing a number "'+Cr(g)+'" from JS side to C/C++ side to an argument of type "'+n+'", which is outside the valid range ['+i+", "+a+"]!");return s?g>>>0:g|0},argPackAdvance:8,readValueFromPointer:Kn(n,f,i!==0),destructorFunction:null})}function $n(r,n,e){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],a=i[n];function f(c){c=c>>2;var o=L,s=o[c],v=o[c+1];return new a(gr,v,s)}e=P(e),j(r,{name:e,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})}function Jn(r,n){n=P(n);var e=n==="std::string";j(r,{name:n,fromWireType:function(i){var a=L[i>>2],f;if(e)for(var c=i+4,o=0;o<=a;++o){var s=i+4+o;if(o==a||C[s]==0){var v=s-c,g=V(c,v);f===void 0?f=g:(f+=String.fromCharCode(0),f+=g),c=s+1}}else{for(var d=new Array(a),o=0;o<a;++o)d[o]=String.fromCharCode(C[i+4+o]);f=d.join("")}return B(i),f},toWireType:function(i,a){a instanceof ArrayBuffer&&(a=new Uint8Array(a));var f,c=typeof a=="string";c||a instanceof Uint8Array||a instanceof Uint8ClampedArray||a instanceof Int8Array||A("Cannot pass non-string to std::string"),e&&c?f=function(){return R(a)}:f=function(){return a.length};var o=f(),s=Ur(4+o+1);if(L[s>>2]=o,e&&c)W(a,s+4,o+1);else if(c)for(var v=0;v<o;++v){var g=a.charCodeAt(v);g>255&&(B(s),A("String has UTF-16 code units that do not fit in 8 bits")),C[s+4+v]=g}else for(var v=0;v<o;++v)C[s+4+v]=a[v];return i!==null&&i.push(B,s),s},argPackAdvance:8,readValueFromPointer:Fr,destructorFunction:function(i){B(i)}})}function Zn(r,n,e){e=P(e);var i,a,f,c,o;n===2?(i=Mr,a=rn,c=nn,f=function(){return yr},o=1):n===4&&(i=en,a=tn,c=an,f=function(){return L},o=2),j(r,{name:e,fromWireType:function(s){for(var v=L[s>>2],g=f(),d,T=s+4,G=0;G<=v;++G){var z=s+4+G*n;if(G==v||g[z>>o]==0){var cr=z-T,ir=i(T,cr);d===void 0?d=ir:(d+=String.fromCharCode(0),d+=ir),T=z+n}}return B(s),d},toWireType:function(s,v){typeof v!="string"&&A("Cannot pass non-string to C++ string type "+e);var g=c(v),d=Ur(4+g+n);return L[d>>2]=g>>o,a(v,d+4,g+n),s!==null&&s.push(B,d),d},argPackAdvance:8,readValueFromPointer:Fr,destructorFunction:function(s){B(s)}})}function Gn(r,n){n=P(n),j(r,{isVoid:!0,name:n,argPackAdvance:0,fromWireType:function(){},toWireType:function(e,i){}})}function sr(r){return r||A("Cannot use deleted val. handle = "+r),E[r].value}function Pr(r,n){var e=Z[r];return e===void 0&&A(n+" has unknown type "+Jr(r)),e}function Qn(r,n,e){r=sr(r),n=Pr(n,"emval::as");var i=[],a=tr(i);return H[e>>2]=a,n.toWireType(i,r)}function Mn(r,n){for(var e=new Array(r),i=0;i<r;++i)e[i]=Pr(H[(n>>2)+i],"parameter "+i);return e}function re(r,n,e,i){r=sr(r);for(var a=Mn(n,e),f=new Array(n),c=0;c<n;++c){var o=a[c];f[c]=o.readValueFromPointer(i),i+=o.argPackAdvance}var s=r.apply(void 0,f);return tr(s)}function ne(r,n){return r=sr(r),n=sr(n),tr(r[n])}function ee(r){r>4&&(E[r].refcount+=1)}function te(r){return r=sr(r),typeof r=="number"}var ie={};function ae(r){var n=ie[r];return n===void 0?P(r):n}function oe(r){return tr(ae(r))}function fe(r){var n=E[r].value;Xr(n),Tr(r)}function se(r,n){r=Pr(r,"_emval_take_value");var e=r.readValueFromPointer(n);return tr(e)}function ce(){J()}function ue(r,n,e){C.copyWithin(r,n,n+e)}function le(r){try{return rr.grow(r-gr.byteLength+65535>>>16),Dr(rr.buffer),1}catch(n){}}function ve(r){var n=C.length;r=r>>>0;var e=2147483648;if(r>e)return!1;for(var i=1;i<=4;i*=2){var a=n*(1+.2/i);a=Math.min(a,r+100663296);var f=Math.min(e,on(Math.max(r,a),65536)),c=le(f);if(c)return!0}return!1}En(),xr=t.BindingError=Ar(Error,"BindingError"),Yr=t.InternalError=Ar(Error,"InternalError"),Sn(),$r=t.UnboundTypeError=Ar(Error,"UnboundTypeError");var pe={a:bn,q:An,u:Pn,t:Wn,m:In,k:Yn,d:Xn,c:$n,n:Jn,l:Zn,v:Gn,j:Qn,w:re,b:Tr,e:ne,g:ee,p:te,f:oe,i:fe,h:se,o:ce,r:ue,s:ve},Ce=wn(),he=t.___wasm_call_ctors=function(){return(he=t.___wasm_call_ctors=t.asm.y).apply(null,arguments)},Ur=t._malloc=function(){return(Ur=t._malloc=t.asm.z).apply(null,arguments)},B=t._free=function(){return(B=t._free=t.asm.A).apply(null,arguments)},Zr=t.___getTypeName=function(){return(Zr=t.___getTypeName=t.asm.C).apply(null,arguments)},_e=t.___embind_register_native_and_builtin_types=function(){return(_e=t.___embind_register_native_and_builtin_types=t.asm.D).apply(null,arguments)},ge=t.dynCall_ijiii=function(){return(ge=t.dynCall_ijiii=t.asm.E).apply(null,arguments)},hr;function de(r){this.name="ExitStatus",this.message="Program terminated with exit("+r+")",this.status=r}fr=function r(){hr||Rr(),hr||(fr=r)};function Rr(r){if(r=r||h,$>0||(un(),$>0))return;function n(){hr||(hr=!0,t.calledRun=!0,!m&&(ln(),u(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),vn()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),n()},1)):n()}if(t.run=Rr,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return Rr(),t.ready}}();typeof exports=="object"&&typeof module=="object"?module.exports=ur:typeof define=="function"&&define.amd?define([],function(){return ur}):typeof exports=="object"&&(exports.Module=ur);var Sr=new Uint8Array([0,0,0,1]);function be(p){console.error(p)}ur.createFile=Wr;function Wr(p=256){let t=0,u=0,_=new Uint8Array(p);return{contents(){return _.slice(0,u)},seek(l){t=l},write(l){let h=l.byteLength;return y(t+h),_.set(l,t),t+=h,u=Math.max(u,t),h}};function y(l){let h=_.length;if(h>=l)return;let k=1024*1024;l=Math.max(l,h*(h<k?2:1.125)>>>0),h!=0&&(l=Math.max(l,256));let I=_;_=new Uint8Array(l),u>0&&_.set(I.subarray(0,u),0)}}ur.isWebCodecsSupported=kr;function kr(){return typeof window!="undefined"&&typeof window.VideoEncoder=="function"}function Qr(p,t={}){let{width:u,height:_,groupOfPictures:y=20,fps:l=30,fragmentation:h=!1,sequential:k=!1,hevc:I=!1,format:x="annexb",codec:Q="avc1.64001E",acceleration:M="no-preference",bitrate:b=2e6,error:U=be,encoderOptions:N={},flushFrequency:lr=10}=t;if(!kr())throw new Error("MP4 H264 encoding/decoding depends on WebCodecs API which is not supported in this environment");if(typeof u!="number"||typeof _!="number")throw new Error("Must specify { width, height } options");if(!isFinite(u)||u<0||!isFinite(_)||_<0)throw new Error("{ width, height } options must be positive integers");let Y=Wr(),O=p.create_muxer({width:u,height:_,fps:l,fragmentation:h,sequential:k,hevc:I},K),q={codec:Q,width:u,height:_,avc:{format:x},hardwareAcceleration:M,bitrate:b,...N},ar=0,F=new window.VideoEncoder({output(m,w){rr(m,w,u,_)},error:U});return F.configure(q),{async end(){return await F.flush(),F.close(),p.finalize_muxer(O),Y.contents()},async addFrame(m){let w=1/l*ar*1e6,X=ar%y==0,D=new VideoFrame(m,{timestamp:w});F.encode(D,{keyFrame:X}),D.close(),lr!=null&&(ar+1)%lr==0&&await F.flush(),ar++},async flush(){return F.flush()}};function K(m,w,X){Y.seek(X);let D=p.HEAPU8.subarray(m,m+w);return Y.write(D)!==D.byteLength}function _r(m){let w=p._malloc(m.byteLength);p.HEAPU8.set(m,w),p.mux_nal(O,w,m.byteLength),p._free(w)}function rr(m,w,X,D){let V=null;if(w.description)try{V=Te(w.description)}catch(R){U(R);return}let vr=new Uint8Array(X*D);m.copyTo(vr);let W=[];if(V&&(V.sps_list.forEach(R=>{W.push(Sr),W.push(R)}),V.pps_list.forEach(R=>{W.push(Sr),W.push(R)})),x==="annexb")W.push(vr);else try{Ee(m.data).forEach(R=>{W.push(Sr),W.push(R)})}catch(R){U(R);return}_r(Ae(W))}}function Ae(p){let t=p.reduce((y,l)=>y+l.byteLength,0),u=new Uint8Array(t),_=0;for(let y=0;y<p.length;y++){let l=p[y];u.set(l,_),_+=l.byteLength}return u}function Ee(p){let t=4,u=0,_=[],y=p.byteLength,l=new Uint8Array(p);for(;u+t<y;){let h=l[u];if(h=(h<<8)+l[u+1],h=(h<<8)+l[u+2],h=(h<<8)+l[u+3],_.push(new Uint8Array(p,u+t,h)),h===0)throw new Error("Error: invalid nal_length 0");u+=t+h}return _}function Te(p){let t=new DataView(p),u=0,_=t.getUint8(u++),y=t.getUint8(u++),l=t.getUint8(u++),h=t.getUint8(u++),k=(t.getUint8(u++)&3)+1;if(k!==4)throw new Error("Expected length_size to indicate 4 bytes");let I=t.getUint8(u++)&31,x=[];for(let b=0;b<I;b++){let U=t.getUint16(u,!1);u+=2;let N=new Uint8Array(t.buffer,u,U);x.push(N),u+=U}let Q=t.getUint8(u++),M=[];for(let b=0;b<Q;b++){let U=t.getUint16(u,!1);u+=2;let N=new Uint8Array(t.buffer,u,U);M.push(N),u+=U}return{offset:u,version:_,profile:y,compat:l,level:h,length_size:k,pps_list:M,sps_list:x,numSPS:I}}
//# sourceMappingURL=mp4.node.js.map
